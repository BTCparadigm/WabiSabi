<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="2195px" preserveAspectRatio="none" style="width:1074px;height:2195px;" version="1.1" viewBox="0 0 1074 2195" width="1074px" zoomAndPan="magnify"><defs><filter height="300%" id="f1cpqwel4ch8of" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="691" x="187" y="26.708">Scenario: A Participant Is Consolidating 2 Coins (Alice1, Alice2) Into 1 (Bob)</text><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="0" x="535.5" y="47.6611"/><rect fill="#FFFFFF" filter="url(#f1cpqwel4ch8of)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="197" y="195.4688"/><rect fill="#FFFFFF" filter="url(#f1cpqwel4ch8of)" height="234.7266" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="197" y="253.7344"/><rect fill="#FFFFFF" filter="url(#f1cpqwel4ch8of)" height="143.9297" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="197" y="545.5938"/><rect fill="#FFFFFF" filter="url(#f1cpqwel4ch8of)" height="234.7266" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="197" y="718.6563"/><rect fill="#FFFFFF" filter="url(#f1cpqwel4ch8of)" height="128.7969" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="197" y="1025.6484"/><rect fill="#FFFFFF" filter="url(#f1cpqwel4ch8of)" height="128.7969" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="197" y="1183.5781"/><rect fill="#FFFFFF" filter="url(#f1cpqwel4ch8of)" height="128.7969" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="197" y="1384.6406"/><rect fill="#FFFFFF" filter="url(#f1cpqwel4ch8of)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="197" y="1585.7031"/><rect fill="#FFFFFF" filter="url(#f1cpqwel4ch8of)" height="128.7969" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="197" y="1643.9688"/><rect fill="#FFFFFF" filter="url(#f1cpqwel4ch8of)" height="128.7969" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="197" y="1801.8984"/><rect fill="#FFFFFF" filter="url(#f1cpqwel4ch8of)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="197" y="2075.2578"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="49" x2="49" y1="121.2031" y2="496.4609"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="49" x2="49" y1="496.4609" y2="524.4609"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="49" x2="49" y1="524.4609" y2="2122.3906"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="202" x2="202" y1="121.2031" y2="496.4609"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="202" x2="202" y1="496.4609" y2="524.4609"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="202" x2="202" y1="524.4609" y2="2122.3906"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="815" x2="815" y1="121.2031" y2="496.4609"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="815" x2="815" y1="496.4609" y2="524.4609"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="815" x2="815" y1="524.4609" y2="2122.3906"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="886" x2="886" y1="121.2031" y2="496.4609"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="886" x2="886" y1="496.4609" y2="524.4609"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="886" x2="886" y1="524.4609" y2="2122.3906"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="950" x2="950" y1="121.2031" y2="496.4609"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="950" x2="950" y1="496.4609" y2="524.4609"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="950" x2="950" y1="524.4609" y2="2122.3906"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1020" x2="1020" y1="2027.9766" y2="2122.3906"/><rect fill="#FEFECE" filter="url(#f1cpqwel4ch8of)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="74" x="12" y="81.9063"/><rect fill="#FEFECE" filter="url(#f1cpqwel4ch8of)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="74" x="8" y="85.9063"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="60" x="15" y="105.9014">Satoshis</text><rect fill="#FEFECE" filter="url(#f1cpqwel4ch8of)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="74" x="12" y="2121.3906"/><rect fill="#FEFECE" filter="url(#f1cpqwel4ch8of)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="74" x="8" y="2125.3906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="60" x="15" y="2145.3857">Satoshis</text><rect fill="#FEFECE" filter="url(#f1cpqwel4ch8of)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="100" x="150" y="85.9063"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="86" x="157" y="105.9014">Coordinator</text><rect fill="#FEFECE" filter="url(#f1cpqwel4ch8of)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="100" x="150" y="2121.3906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="86" x="157" y="2141.3857">Coordinator</text><rect fill="#FEFECE" filter="url(#f1cpqwel4ch8of)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="58" x="784" y="85.9063"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="44" x="791" y="105.9014">Alice1</text><rect fill="#FEFECE" filter="url(#f1cpqwel4ch8of)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="58" x="784" y="2121.3906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="44" x="791" y="2141.3857">Alice1</text><rect fill="#FEFECE" filter="url(#f1cpqwel4ch8of)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="57" x="856" y="85.9063"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="43" x="863" y="105.9014">Alice2</text><rect fill="#FEFECE" filter="url(#f1cpqwel4ch8of)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="57" x="856" y="2121.3906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="43" x="863" y="2141.3857">Alice2</text><rect fill="#FEFECE" filter="url(#f1cpqwel4ch8of)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="43" x="927" y="85.9063"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="29" x="934" y="105.9014">Bob</text><rect fill="#FEFECE" filter="url(#f1cpqwel4ch8of)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="43" x="927" y="2121.3906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="29" x="934" y="2141.3857">Bob</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="67" x="984" y="2134.3857">Mempool</text><path d="M1002.5,2147.6875 C1002.5,2137.6875 1020.5,2137.6875 1020.5,2137.6875 C1020.5,2137.6875 1038.5,2137.6875 1038.5,2147.6875 L1038.5,2173.6875 C1038.5,2183.6875 1020.5,2183.6875 1020.5,2183.6875 C1020.5,2183.6875 1002.5,2183.6875 1002.5,2173.6875 L1002.5,2147.6875 " fill="#FEFECE" filter="url(#f1cpqwel4ch8of)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M1002.5,2147.6875 C1002.5,2157.6875 1020.5,2157.6875 1020.5,2157.6875 C1020.5,2157.6875 1038.5,2157.6875 1038.5,2147.6875 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><rect fill="#FFFFFF" filter="url(#f1cpqwel4ch8of)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="197" y="195.4688"/><rect fill="#FFFFFF" filter="url(#f1cpqwel4ch8of)" height="234.7266" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="197" y="253.7344"/><rect fill="#FFFFFF" filter="url(#f1cpqwel4ch8of)" height="143.9297" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="197" y="545.5938"/><rect fill="#FFFFFF" filter="url(#f1cpqwel4ch8of)" height="234.7266" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="197" y="718.6563"/><rect fill="#FFFFFF" filter="url(#f1cpqwel4ch8of)" height="128.7969" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="197" y="1025.6484"/><rect fill="#FFFFFF" filter="url(#f1cpqwel4ch8of)" height="128.7969" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="197" y="1183.5781"/><rect fill="#FFFFFF" filter="url(#f1cpqwel4ch8of)" height="128.7969" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="197" y="1384.6406"/><rect fill="#FFFFFF" filter="url(#f1cpqwel4ch8of)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="197" y="1585.7031"/><rect fill="#FFFFFF" filter="url(#f1cpqwel4ch8of)" height="128.7969" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="197" y="1643.9688"/><rect fill="#FFFFFF" filter="url(#f1cpqwel4ch8of)" height="128.7969" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="197" y="1801.8984"/><rect fill="#FFFFFF" filter="url(#f1cpqwel4ch8of)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="197" y="2075.2578"/><rect fill="#EEEEEE" filter="url(#f1cpqwel4ch8of)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1059" x="3" y="151.7695"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1062" y1="151.7695" y2="151.7695"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1062" y1="154.7695" y2="154.7695"/><rect fill="#EEEEEE" filter="url(#f1cpqwel4ch8of)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="159" x="453" y="141.2031"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="140" x="459" y="157.27">Input Registration</text><polygon fill="#A80036" points="185,191.4688,195,195.4688,185,199.4688,189,195.4688" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="49" x2="191" y1="195.4688" y2="195.4688"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="129" x="56" y="190.4028">GetCoinjoinStatuses</text><polygon fill="#A80036" points="60,220.6016,50,224.6016,60,228.6016,56,224.6016" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="54" x2="201" y1="224.6016" y2="224.6016"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="116" x="66" y="219.5356">CoinjoinStatuses[]</text><polygon fill="#A80036" points="218,249.7344,208,253.7344,218,257.7344,214,253.7344" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="212" x2="814" y1="253.7344" y2="253.7344"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="356" x="224" y="248.6685">IREG - RoundId, Input, RoundParamSig, ZeroCredReqs[]</text><path d="M212,266.7344 L212,457.7344 L392,457.7344 L392,276.7344 L382,266.7344 L212,266.7344 " fill="#FBFB77" filter="url(#f1cpqwel4ch8of)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M382,266.7344 L382,276.7344 L392,276.7344 L382,266.7344 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="100" x="218" y="283.8013">IsRoundFound()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="87" x="218" y="298.9341">IsIRegPhase()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="73" x="218" y="314.0669">IsUnspent()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="87" x="218" y="329.1997">IsConfirmed()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="64" x="218" y="344.3325">IsMature()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="114" x="218" y="359.4653">IsStandardScript()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="101" x="218" y="374.5981">IsNotMalleable()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="151" x="218" y="389.731">CheckRoundParamSig()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="159" x="218" y="404.8638">IsAllowedIfBlameRound()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="90" x="218" y="419.9966">IsNotBanned()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="156" x="218" y="435.1294">UpdateIfDuplicateInput()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="117" x="218" y="450.2622">SetAliceDeadline()</text><polygon fill="#A80036" points="803,484.4609,813,488.4609,803,492.4609,807,488.4609" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="202" x2="809" y1="488.4609" y2="488.4609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="127" x="209" y="483.395">AliceId, ZeroCreds[]</text><polygon fill="#A80036" points="218,541.5938,208,545.5938,218,549.5938,214,545.5938" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="212" x2="814" y1="545.5938" y2="545.5938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="589" x="224" y="540.5278">CCONF - RoundId, AliceId, PresentedCreds[], RealCredReqs[], BalanceProof, ZeroCredReqs[]</text><path d="M212,558.5938 L212,658.5938 L417,658.5938 L417,568.5938 L407,558.5938 L212,558.5938 " fill="#FBFB77" filter="url(#f1cpqwel4ch8of)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M407,558.5938 L407,568.5938 L417,568.5938 L407,558.5938 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="100" x="218" y="575.6606">IsRoundFound()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="141" x="218" y="590.7935">IsIRegOrCConfPhase()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="89" x="218" y="605.9263">IsAliceFound()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="184" x="218" y="621.0591">EnsureUniqueSerialNumber()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="120" x="218" y="636.1919">CheckCredProofs()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="133" x="218" y="651.3247">ResetAliceDeadline()</text><polygon fill="#A80036" points="803,685.5234,813,689.5234,803,693.5234,807,689.5234" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="202" x2="809" y1="689.5234" y2="689.5234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="78" x="209" y="684.4575">ZeroCreds[]</text><polygon fill="#A80036" points="218,714.6563,208,718.6563,218,722.6563,214,718.6563" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="212" x2="885.5" y1="718.6563" y2="718.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="356" x="224" y="713.5903">IREG - RoundId, Input, RoundParamSig, ZeroCredReqs[]</text><path d="M212,731.6563 L212,922.6563 L392,922.6563 L392,741.6563 L382,731.6563 L212,731.6563 " fill="#FBFB77" filter="url(#f1cpqwel4ch8of)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M382,731.6563 L382,741.6563 L392,741.6563 L382,731.6563 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="100" x="218" y="748.7231">IsRoundFound()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="87" x="218" y="763.856">IsIRegPhase()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="73" x="218" y="778.9888">IsUnspent()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="87" x="218" y="794.1216">IsConfirmed()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="64" x="218" y="809.2544">IsMature()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="114" x="218" y="824.3872">IsStandardScript()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="101" x="218" y="839.52">IsNotMalleable()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="151" x="218" y="854.6528">CheckRoundParamSig()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="159" x="218" y="869.7856">IsAllowedIfBlameRound()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="90" x="218" y="884.9185">IsNotBanned()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="156" x="218" y="900.0513">UpdateIfDuplicateInput()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="117" x="218" y="915.1841">SetAliceDeadline()</text><polygon fill="#A80036" points="874.5,949.3828,884.5,953.3828,874.5,957.3828,878.5,953.3828" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="202" x2="880.5" y1="953.3828" y2="953.3828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="127" x="209" y="948.3169">AliceId, ZeroCreds[]</text><rect fill="#EEEEEE" filter="url(#f1cpqwel4ch8of)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1059" x="3" y="981.9492"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1062" y1="981.9492" y2="981.9492"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1062" y1="984.9492" y2="984.9492"/><rect fill="#EEEEEE" filter="url(#f1cpqwel4ch8of)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="211" x="427" y="971.3828"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="192" x="433" y="987.4497">Connection Confirmation</text><polygon fill="#A80036" points="218,1021.6484,208,1025.6484,218,1029.6484,214,1025.6484" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="212" x2="814" y1="1025.6484" y2="1025.6484"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="589" x="224" y="1020.5825">CCONF - RoundId, AliceId, PresentedCreds[], RealCredReqs[], BalanceProof, ZeroCredReqs[]</text><path d="M212,1038.6484 L212,1123.6484 L417,1123.6484 L417,1048.6484 L407,1038.6484 L212,1038.6484 " fill="#FBFB77" filter="url(#f1cpqwel4ch8of)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M407,1038.6484 L407,1048.6484 L417,1048.6484 L407,1038.6484 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="100" x="218" y="1055.7153">IsRoundFound()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="141" x="218" y="1070.8481">IsIRegOrCConfPhase()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="89" x="218" y="1085.981">IsAliceFound()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="184" x="218" y="1101.1138">EnsureUniqueSerialNumber()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="120" x="218" y="1116.2466">CheckCredProofs()</text><polygon fill="#A80036" points="803,1150.4453,813,1154.4453,803,1158.4453,807,1154.4453" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="202" x2="809" y1="1154.4453" y2="1154.4453"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="75" x="209" y="1149.3794">RealCreds[]</text><polygon fill="#A80036" points="218,1179.5781,208,1183.5781,218,1187.5781,214,1183.5781" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="212" x2="885.5" y1="1183.5781" y2="1183.5781"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="589" x="224" y="1178.5122">CCONF - RoundId, AliceId, PresentedCreds[], RealCredReqs[], BalanceProof, ZeroCredReqs[]</text><path d="M212,1196.5781 L212,1281.5781 L417,1281.5781 L417,1206.5781 L407,1196.5781 L212,1196.5781 " fill="#FBFB77" filter="url(#f1cpqwel4ch8of)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M407,1196.5781 L407,1206.5781 L417,1206.5781 L407,1196.5781 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="100" x="218" y="1213.645">IsRoundFound()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="141" x="218" y="1228.7778">IsIRegOrCConfPhase()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="89" x="218" y="1243.9106">IsAliceFound()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="184" x="218" y="1259.0435">EnsureUniqueSerialNumber()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="120" x="218" y="1274.1763">CheckCredProofs()</text><polygon fill="#A80036" points="874.5,1308.375,884.5,1312.375,874.5,1316.375,878.5,1312.375" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="202" x2="880.5" y1="1312.375" y2="1312.375"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="75" x="209" y="1307.3091">RealCreds[]</text><rect fill="#EEEEEE" filter="url(#f1cpqwel4ch8of)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1059" x="3" y="1340.9414"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1062" y1="1340.9414" y2="1340.9414"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1062" y1="1343.9414" y2="1343.9414"/><rect fill="#EEEEEE" filter="url(#f1cpqwel4ch8of)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="173" x="446" y="1330.375"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="154" x="452" y="1346.4419">Output Registration</text><polygon fill="#A80036" points="218,1380.6406,208,1384.6406,218,1388.6406,214,1384.6406" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="212" x2="949.5" y1="1384.6406" y2="1384.6406"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="274" x="224" y="1379.5747">OREG - RoundId, Output, PresentedCreds[]</text><path d="M212,1397.6406 L212,1482.6406 L417,1482.6406 L417,1407.6406 L407,1397.6406 L212,1397.6406 " fill="#FBFB77" filter="url(#f1cpqwel4ch8of)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M407,1397.6406 L407,1407.6406 L417,1407.6406 L407,1397.6406 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="100" x="218" y="1414.7075">IsRoundFound()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="94" x="218" y="1429.8403">IsORegPhase()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="114" x="218" y="1444.9731">IsStandardScript()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="184" x="218" y="1460.106">EnsureUniqueSerialNumber()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="120" x="218" y="1475.2388">CheckCredProofs()</text><polygon fill="#A80036" points="938.5,1509.4375,948.5,1513.4375,938.5,1517.4375,942.5,1513.4375" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="202" x2="944.5" y1="1513.4375" y2="1513.4375"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="175" x="209" y="1508.3716">UnsignedTransactionSecret</text><rect fill="#EEEEEE" filter="url(#f1cpqwel4ch8of)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1059" x="3" y="1542.0039"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1062" y1="1542.0039" y2="1542.0039"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1062" y1="1545.0039" y2="1545.0039"/><rect fill="#EEEEEE" filter="url(#f1cpqwel4ch8of)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="169" x="448" y="1531.4375"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="150" x="454" y="1547.5044">Transaction Signing</text><polygon fill="#A80036" points="185,1581.7031,195,1585.7031,185,1589.7031,189,1585.7031" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="49" x2="191" y1="1585.7031" y2="1585.7031"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="129" x="56" y="1580.6372">GetCoinjoinStatuses</text><polygon fill="#A80036" points="60,1610.8359,50,1614.8359,60,1618.8359,56,1614.8359" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="54" x2="201" y1="1614.8359" y2="1614.8359"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="116" x="66" y="1609.77">CoinjoinStatuses[]</text><polygon fill="#A80036" points="218,1639.9688,208,1643.9688,218,1647.9688,214,1643.9688" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="212" x2="814" y1="1643.9688" y2="1643.9688"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="202" x="224" y="1638.9028">TSIG - RoundId, AliceId, InputSig</text><path d="M212,1656.9688 L212,1741.9688 L389,1741.9688 L389,1666.9688 L379,1656.9688 L212,1656.9688 " fill="#FBFB77" filter="url(#f1cpqwel4ch8of)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M379,1656.9688 L379,1666.9688 L389,1666.9688 L379,1656.9688 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="100" x="218" y="1674.0356">IsRoundFound()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="86" x="218" y="1689.1685">IsTSigPhase()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="89" x="218" y="1704.3013">IsAliceFound()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="100" x="218" y="1719.4341">CheckInputSig()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="156" x="218" y="1734.5669">UpdateIfAlreadySigned()</text><polygon fill="#A80036" points="803,1768.7656,813,1772.7656,803,1776.7656,807,1772.7656" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="202" x2="809" y1="1772.7656" y2="1772.7656"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="26" x="209" y="1767.6997">ACK</text><polygon fill="#A80036" points="218,1797.8984,208,1801.8984,218,1805.8984,214,1801.8984" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="212" x2="885.5" y1="1801.8984" y2="1801.8984"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="202" x="224" y="1796.8325">TSIG - RoundId, AliceId, InputSig</text><path d="M212,1814.8984 L212,1899.8984 L389,1899.8984 L389,1824.8984 L379,1814.8984 L212,1814.8984 " fill="#FBFB77" filter="url(#f1cpqwel4ch8of)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M379,1814.8984 L379,1824.8984 L389,1824.8984 L379,1814.8984 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="100" x="218" y="1831.9653">IsRoundFound()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="86" x="218" y="1847.0981">IsTSigPhase()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="89" x="218" y="1862.231">IsAliceFound()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="100" x="218" y="1877.3638">CheckInputSig()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="156" x="218" y="1892.4966">UpdateIfAlreadySigned()</text><polygon fill="#A80036" points="874.5,1926.6953,884.5,1930.6953,874.5,1934.6953,878.5,1930.6953" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="202" x2="880.5" y1="1930.6953" y2="1930.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="26" x="209" y="1925.6294">ACK</text><rect fill="#EEEEEE" filter="url(#f1cpqwel4ch8of)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1059" x="3" y="1959.2617"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1062" y1="1959.2617" y2="1959.2617"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1062" y1="1962.2617" y2="1962.2617"/><rect fill="#EEEEEE" filter="url(#f1cpqwel4ch8of)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="216" x="424.5" y="1948.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="197" x="430.5" y="1964.7622">Transaction Broadcasting</text><polygon fill="#A80036" points="972,1998.9609,982,2002.9609,972,2006.9609,976,2002.9609" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="202" x2="978" y1="2002.9609" y2="2002.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="118" x="209" y="1997.895">SignedTransaction</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="67" x="984" y="2040.8232">Mempool</text><path d="M1002.5,1991.8281 C1002.5,1981.8281 1020.5,1981.8281 1020.5,1981.8281 C1020.5,1981.8281 1038.5,1981.8281 1038.5,1991.8281 L1038.5,2017.8281 C1038.5,2027.8281 1020.5,2027.8281 1020.5,2027.8281 C1020.5,2027.8281 1002.5,2027.8281 1002.5,2017.8281 L1002.5,1991.8281 " fill="#FEFECE" filter="url(#f1cpqwel4ch8of)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M1002.5,1991.8281 C1002.5,2001.8281 1020.5,2001.8281 1020.5,2001.8281 C1020.5,2001.8281 1038.5,2001.8281 1038.5,1991.8281 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><polygon fill="#A80036" points="185,2071.2578,195,2075.2578,185,2079.2578,189,2075.2578" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="49" x2="191" y1="2075.2578" y2="2075.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="129" x="56" y="2070.1919">GetCoinjoinStatuses</text><polygon fill="#A80036" points="60,2100.3906,50,2104.3906,60,2108.3906,56,2104.3906" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="54" x2="201" y1="2104.3906" y2="2104.3906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="116" x="66" y="2099.3247">CoinjoinStatuses[]</text><!--MD5=[a496ae56dabdd10b4c03190444851f05]
@startuml
collections Satoshis
participant Coordinator
participant Alice1
participant Alice2
participant Bob
database Mempool

title Scenario: A Participant Is Consolidating 2 Coins (Alice1, Alice2) Into 1 (Bob)\n

== Input Registration ==

Satoshis -> Coordinator ++ : GetCoinjoinStatuses
return CoinjoinStatuses[]

Alice1 -> Coordinator ++: IREG - RoundId, Input, RoundParamSig, ZeroCredReqs[]
note right of Coordinator
    IsRoundFound()
    IsIRegPhase()
    IsUnspent()
    IsConfirmed()
    IsMature()
    IsStandardScript()
    IsNotMalleable()
    CheckRoundParamSig()
    IsAllowedIfBlameRound()
    IsNotBanned()
    UpdateIfDuplicateInput()
    SetAliceDeadline()
end note
return AliceId, ZeroCreds[]
...

Alice1 -> Coordinator ++: CCONF - RoundId, AliceId, PresentedCreds[], RealCredReqs[], BalanceProof, ZeroCredReqs[]
note right of Coordinator
    IsRoundFound()
    IsIRegOrCConfPhase()
    IsAliceFound()
    EnsureUniqueSerialNumber()
    CheckCredProofs()
    ResetAliceDeadline()
end note
return ZeroCreds[]

Alice2 -> Coordinator ++: IREG - RoundId, Input, RoundParamSig, ZeroCredReqs[]
note right of Coordinator
    IsRoundFound()
    IsIRegPhase()
    IsUnspent()
    IsConfirmed()
    IsMature()
    IsStandardScript()
    IsNotMalleable()
    CheckRoundParamSig()
    IsAllowedIfBlameRound()
    IsNotBanned()
    UpdateIfDuplicateInput()
    SetAliceDeadline()
end note
return AliceId, ZeroCreds[]

== Connection Confirmation ==

Alice1 -> Coordinator ++: CCONF - RoundId, AliceId, PresentedCreds[], RealCredReqs[], BalanceProof, ZeroCredReqs[]
note right of Coordinator
    IsRoundFound()
    IsIRegOrCConfPhase()
    IsAliceFound()
    EnsureUniqueSerialNumber()
    CheckCredProofs()
end note
return RealCreds[]

Alice2 -> Coordinator ++: CCONF - RoundId, AliceId, PresentedCreds[], RealCredReqs[], BalanceProof, ZeroCredReqs[]
note right of Coordinator
    IsRoundFound()
    IsIRegOrCConfPhase()
    IsAliceFound()
    EnsureUniqueSerialNumber()
    CheckCredProofs()
end note
return RealCreds[]

== Output Registration ==

Bob -> Coordinator ++: OREG - RoundId, Output, PresentedCreds[]
note right of Coordinator
    IsRoundFound()
    IsORegPhase()
    IsStandardScript()
    EnsureUniqueSerialNumber()
    CheckCredProofs()
end note
return UnsignedTransactionSecret

== Transaction Signing ==

Satoshis -> Coordinator ++ : GetCoinjoinStatuses
return CoinjoinStatuses[]

Alice1 -> Coordinator ++: TSIG - RoundId, AliceId, InputSig
note right of Coordinator
    IsRoundFound()
    IsTSigPhase()
    IsAliceFound()
    CheckInputSig()
    UpdateIfAlreadySigned()
end note
return ACK

Alice2 -> Coordinator ++: TSIG - RoundId, AliceId, InputSig
note right of Coordinator
    IsRoundFound()
    IsTSigPhase()
    IsAliceFound()
    CheckInputSig()
    UpdateIfAlreadySigned()
end note
return ACK

== Transaction Broadcasting ==

Coordinator -> Mempool**  : SignedTransaction

Satoshis -> Coordinator ++ : GetCoinjoinStatuses
return CoinjoinStatuses[]
@enduml

PlantUML version 1.2020.16beta3(Unknown compile time)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>
