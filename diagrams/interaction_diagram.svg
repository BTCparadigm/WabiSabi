<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="2052px" preserveAspectRatio="none" style="width:1064px;height:2052px;" version="1.1" viewBox="0 0 1064 2052" width="1064px" zoomAndPan="magnify"><defs><filter height="300%" id="ftpncyiypvnn3" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="594" x="230.5" y="22.9951">Scenario: A Participant Is Consolidating 2 Coins (Alice1, Alice2) Into 1 (Bob)</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="0" x="530" y="39.292"/><rect fill="#FFFFFF" filter="url(#ftpncyiypvnn3)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="197.5" y="186.1563"/><rect fill="#FFFFFF" filter="url(#ftpncyiypvnn3)" height="219.5938" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="197.5" y="244.4219"/><rect fill="#FFFFFF" filter="url(#ftpncyiypvnn3)" height="128.7969" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="197.5" y="521.1484"/><rect fill="#FFFFFF" filter="url(#ftpncyiypvnn3)" height="219.5938" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="197.5" y="679.0781"/><rect fill="#FFFFFF" filter="url(#ftpncyiypvnn3)" height="128.7969" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="197.5" y="970.9375"/><rect fill="#FFFFFF" filter="url(#ftpncyiypvnn3)" height="128.7969" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="197.5" y="1128.8672"/><rect fill="#FFFFFF" filter="url(#ftpncyiypvnn3)" height="128.7969" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="197.5" y="1329.9297"/><rect fill="#FFFFFF" filter="url(#ftpncyiypvnn3)" height="113.6641" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="197.5" y="1530.9922"/><rect fill="#FFFFFF" filter="url(#ftpncyiypvnn3)" height="113.6641" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="197.5" y="1673.7891"/><rect fill="#FFFFFF" filter="url(#ftpncyiypvnn3)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="197.5" y="1932.0156"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="64" x="977" y="1897.5811">Mempool</text><path d="M994,1848.5859 C994,1838.5859 1012,1838.5859 1012,1838.5859 C1012,1838.5859 1030,1838.5859 1030,1848.5859 L1030,1874.5859 C1030,1884.5859 1012,1884.5859 1012,1884.5859 C1012,1884.5859 994,1884.5859 994,1874.5859 L994,1848.5859 " fill="#FEFECE" filter="url(#ftpncyiypvnn3)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M994,1848.5859 C994,1858.5859 1012,1858.5859 1012,1858.5859 C1012,1858.5859 1030,1858.5859 1030,1848.5859 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="48" x2="48" y1="111.8906" y2="472.0156"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="48" x2="48" y1="472.0156" y2="500.0156"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="48" x2="48" y1="500.0156" y2="1979.1484"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="202" x2="202" y1="111.8906" y2="472.0156"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="202" x2="202" y1="472.0156" y2="500.0156"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="202" x2="202" y1="500.0156" y2="1979.1484"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="812" x2="812" y1="111.8906" y2="472.0156"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="812" x2="812" y1="472.0156" y2="500.0156"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="812" x2="812" y1="500.0156" y2="1979.1484"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="881" x2="881" y1="111.8906" y2="472.0156"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="881" x2="881" y1="472.0156" y2="500.0156"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="881" x2="881" y1="500.0156" y2="1979.1484"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="944" x2="944" y1="111.8906" y2="472.0156"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="944" x2="944" y1="472.0156" y2="500.0156"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="944" x2="944" y1="500.0156" y2="1979.1484"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1012" x2="1012" y1="1884.7344" y2="1979.1484"/><rect fill="#FEFECE" filter="url(#ftpncyiypvnn3)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="73" x="12" y="72.5938"/><rect fill="#FEFECE" filter="url(#ftpncyiypvnn3)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="73" x="8" y="76.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="59" x="15" y="96.5889">Satoshis</text><rect fill="#FEFECE" filter="url(#ftpncyiypvnn3)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="73" x="12" y="1978.1484"/><rect fill="#FEFECE" filter="url(#ftpncyiypvnn3)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="73" x="8" y="1982.1484"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="59" x="15" y="2002.1436">Satoshis</text><rect fill="#FEFECE" filter="url(#ftpncyiypvnn3)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="95" x="153" y="76.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="81" x="160" y="96.5889">Coordinator</text><rect fill="#FEFECE" filter="url(#ftpncyiypvnn3)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="95" x="153" y="1978.1484"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="81" x="160" y="1998.1436">Coordinator</text><rect fill="#FEFECE" filter="url(#ftpncyiypvnn3)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="55" x="783" y="76.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="41" x="790" y="96.5889">Alice1</text><rect fill="#FEFECE" filter="url(#ftpncyiypvnn3)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="55" x="783" y="1978.1484"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="41" x="790" y="1998.1436">Alice1</text><rect fill="#FEFECE" filter="url(#ftpncyiypvnn3)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="55" x="852" y="76.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="41" x="859" y="96.5889">Alice2</text><rect fill="#FEFECE" filter="url(#ftpncyiypvnn3)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="55" x="852" y="1978.1484"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="41" x="859" y="1998.1436">Alice2</text><rect fill="#FEFECE" filter="url(#ftpncyiypvnn3)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="42" x="921" y="76.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="28" x="928" y="96.5889">Bob</text><rect fill="#FEFECE" filter="url(#ftpncyiypvnn3)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="42" x="921" y="1978.1484"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="28" x="928" y="1998.1436">Bob</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="64" x="977" y="1991.1436">Mempool</text><path d="M994,2004.4453 C994,1994.4453 1012,1994.4453 1012,1994.4453 C1012,1994.4453 1030,1994.4453 1030,2004.4453 L1030,2030.4453 C1030,2040.4453 1012,2040.4453 1012,2040.4453 C1012,2040.4453 994,2040.4453 994,2030.4453 L994,2004.4453 " fill="#FEFECE" filter="url(#ftpncyiypvnn3)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M994,2004.4453 C994,2014.4453 1012,2014.4453 1012,2014.4453 C1012,2014.4453 1030,2014.4453 1030,2004.4453 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><rect fill="#FFFFFF" filter="url(#ftpncyiypvnn3)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="197.5" y="186.1563"/><rect fill="#FFFFFF" filter="url(#ftpncyiypvnn3)" height="219.5938" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="197.5" y="244.4219"/><rect fill="#FFFFFF" filter="url(#ftpncyiypvnn3)" height="128.7969" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="197.5" y="521.1484"/><rect fill="#FFFFFF" filter="url(#ftpncyiypvnn3)" height="219.5938" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="197.5" y="679.0781"/><rect fill="#FFFFFF" filter="url(#ftpncyiypvnn3)" height="128.7969" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="197.5" y="970.9375"/><rect fill="#FFFFFF" filter="url(#ftpncyiypvnn3)" height="128.7969" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="197.5" y="1128.8672"/><rect fill="#FFFFFF" filter="url(#ftpncyiypvnn3)" height="128.7969" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="197.5" y="1329.9297"/><rect fill="#FFFFFF" filter="url(#ftpncyiypvnn3)" height="113.6641" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="197.5" y="1530.9922"/><rect fill="#FFFFFF" filter="url(#ftpncyiypvnn3)" height="113.6641" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="197.5" y="1673.7891"/><rect fill="#FFFFFF" filter="url(#ftpncyiypvnn3)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="197.5" y="1932.0156"/><rect fill="#EEEEEE" filter="url(#ftpncyiypvnn3)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1049" x="3" y="142.457"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1052" y1="142.457" y2="142.457"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1052" y1="145.457" y2="145.457"/><rect fill="#EEEEEE" filter="url(#ftpncyiypvnn3)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="152" x="451.5" y="131.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="133" x="457.5" y="147.9575">Input Registration</text><polygon fill="#A80036" points="185.5,182.1563,195.5,186.1563,185.5,190.1563,189.5,186.1563" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="48.5" x2="191.5" y1="186.1563" y2="186.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="130" x="55.5" y="181.0903">GetCoinjoinStatuses</text><polygon fill="#A80036" points="59.5,211.2891,49.5,215.2891,59.5,219.2891,55.5,215.2891" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="53.5" x2="201.5" y1="215.2891" y2="215.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="117" x="65.5" y="210.2231">CoinjoinStatuses[]</text><polygon fill="#A80036" points="218.5,240.4219,208.5,244.4219,218.5,248.4219,214.5,244.4219" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="212.5" x2="811.5" y1="244.4219" y2="244.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="353" x="224.5" y="239.356">IREG - RoundId, Input, RoundParamSig, ZeroCredReqs[]</text><path d="M212,257.4219 L212,433.4219 L389,433.4219 L389,267.4219 L379,257.4219 L212,257.4219 " fill="#FBFB77" filter="url(#ftpncyiypvnn3)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M379,257.4219 L379,267.4219 L389,267.4219 L379,257.4219 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="99" x="218" y="274.4888">IsRoundFound()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="86" x="218" y="289.6216">IsIRegPhase()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="74" x="218" y="304.7544">IsUnspent()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="86" x="218" y="319.8872">IsConfirmed()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="65" x="218" y="335.02">IsMature()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="116" x="218" y="350.1528">IsStandardScript()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="103" x="218" y="365.2856">IsNotMalleable()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="151" x="218" y="380.4185">CheckRoundParamSig()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="156" x="218" y="395.5513">IsAllowedIfBlameRound()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="92" x="218" y="410.6841">IsNotBanned()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="156" x="218" y="425.8169">UpdateIfDuplicateInput()</text><polygon fill="#A80036" points="800.5,460.0156,810.5,464.0156,800.5,468.0156,804.5,464.0156" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="202.5" x2="806.5" y1="464.0156" y2="464.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="127" x="209.5" y="458.9497">AliceId, ZeroCreds[]</text><polygon fill="#A80036" points="218.5,517.1484,208.5,521.1484,218.5,525.1484,214.5,521.1484" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="212.5" x2="811.5" y1="521.1484" y2="521.1484"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="586" x="224.5" y="516.0825">CCONF - RoundId, AliceId, PresentedCreds[], RealCredReqs[], BalanceProof, ZeroCredReqs[]</text><path d="M212,534.1484 L212,619.1484 L420,619.1484 L420,544.1484 L410,534.1484 L212,534.1484 " fill="#FBFB77" filter="url(#ftpncyiypvnn3)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M410,534.1484 L410,544.1484 L420,544.1484 L410,534.1484 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="99" x="218" y="551.2153">IsRoundFound()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="139" x="218" y="566.3481">IsIRegOrCConfPhase()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="89" x="218" y="581.481">IsAliceFound()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="187" x="218" y="596.6138">EnsureUniqueSerialNumber()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="119" x="218" y="611.7466">CheckCredProofs()</text><polygon fill="#A80036" points="800.5,645.9453,810.5,649.9453,800.5,653.9453,804.5,649.9453" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="202.5" x2="806.5" y1="649.9453" y2="649.9453"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="78" x="209.5" y="644.8794">ZeroCreds[]</text><polygon fill="#A80036" points="218.5,675.0781,208.5,679.0781,218.5,683.0781,214.5,679.0781" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="212.5" x2="880.5" y1="679.0781" y2="679.0781"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="353" x="224.5" y="674.0122">IREG - RoundId, Input, RoundParamSig, ZeroCredReqs[]</text><path d="M212,692.0781 L212,868.0781 L389,868.0781 L389,702.0781 L379,692.0781 L212,692.0781 " fill="#FBFB77" filter="url(#ftpncyiypvnn3)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M379,692.0781 L379,702.0781 L389,702.0781 L379,692.0781 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="99" x="218" y="709.145">IsRoundFound()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="86" x="218" y="724.2778">IsIRegPhase()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="74" x="218" y="739.4106">IsUnspent()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="86" x="218" y="754.5435">IsConfirmed()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="65" x="218" y="769.6763">IsMature()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="116" x="218" y="784.8091">IsStandardScript()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="103" x="218" y="799.9419">IsNotMalleable()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="151" x="218" y="815.0747">CheckRoundParamSig()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="156" x="218" y="830.2075">IsAllowedIfBlameRound()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="92" x="218" y="845.3403">IsNotBanned()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="156" x="218" y="860.4731">UpdateIfDuplicateInput()</text><polygon fill="#A80036" points="869.5,894.6719,879.5,898.6719,869.5,902.6719,873.5,898.6719" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="202.5" x2="875.5" y1="898.6719" y2="898.6719"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="127" x="209.5" y="893.606">AliceId, ZeroCreds[]</text><rect fill="#EEEEEE" filter="url(#ftpncyiypvnn3)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1049" x="3" y="927.2383"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1052" y1="927.2383" y2="927.2383"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1052" y1="930.2383" y2="930.2383"/><rect fill="#EEEEEE" filter="url(#ftpncyiypvnn3)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="201" x="427" y="916.6719"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="182" x="433" y="932.7388">Connection Confirmation</text><polygon fill="#A80036" points="218.5,966.9375,208.5,970.9375,218.5,974.9375,214.5,970.9375" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="212.5" x2="811.5" y1="970.9375" y2="970.9375"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="586" x="224.5" y="965.8716">CCONF - RoundId, AliceId, PresentedCreds[], RealCredReqs[], BalanceProof, ZeroCredReqs[]</text><path d="M212,983.9375 L212,1068.9375 L420,1068.9375 L420,993.9375 L410,983.9375 L212,983.9375 " fill="#FBFB77" filter="url(#ftpncyiypvnn3)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M410,983.9375 L410,993.9375 L420,993.9375 L410,983.9375 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="99" x="218" y="1001.0044">IsRoundFound()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="139" x="218" y="1016.1372">IsIRegOrCConfPhase()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="89" x="218" y="1031.27">IsAliceFound()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="187" x="218" y="1046.4028">EnsureUniqueSerialNumber()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="119" x="218" y="1061.5356">CheckCredProofs()</text><polygon fill="#A80036" points="800.5,1095.7344,810.5,1099.7344,800.5,1103.7344,804.5,1099.7344" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="202.5" x2="806.5" y1="1099.7344" y2="1099.7344"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="74" x="209.5" y="1094.6685">RealCreds[]</text><polygon fill="#A80036" points="218.5,1124.8672,208.5,1128.8672,218.5,1132.8672,214.5,1128.8672" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="212.5" x2="880.5" y1="1128.8672" y2="1128.8672"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="586" x="224.5" y="1123.8013">CCONF - RoundId, AliceId, PresentedCreds[], RealCredReqs[], BalanceProof, ZeroCredReqs[]</text><path d="M212,1141.8672 L212,1226.8672 L420,1226.8672 L420,1151.8672 L410,1141.8672 L212,1141.8672 " fill="#FBFB77" filter="url(#ftpncyiypvnn3)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M410,1141.8672 L410,1151.8672 L420,1151.8672 L410,1141.8672 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="99" x="218" y="1158.9341">IsRoundFound()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="139" x="218" y="1174.0669">IsIRegOrCConfPhase()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="89" x="218" y="1189.1997">IsAliceFound()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="187" x="218" y="1204.3325">EnsureUniqueSerialNumber()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="119" x="218" y="1219.4653">CheckCredProofs()</text><polygon fill="#A80036" points="869.5,1253.6641,879.5,1257.6641,869.5,1261.6641,873.5,1257.6641" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="202.5" x2="875.5" y1="1257.6641" y2="1257.6641"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="74" x="209.5" y="1252.5981">RealCreds[]</text><rect fill="#EEEEEE" filter="url(#ftpncyiypvnn3)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1049" x="3" y="1286.2305"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1052" y1="1286.2305" y2="1286.2305"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1052" y1="1289.2305" y2="1289.2305"/><rect fill="#EEEEEE" filter="url(#ftpncyiypvnn3)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="165" x="445" y="1275.6641"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="146" x="451" y="1291.731">Output Registration</text><polygon fill="#A80036" points="218.5,1325.9297,208.5,1329.9297,218.5,1333.9297,214.5,1329.9297" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="212.5" x2="943" y1="1329.9297" y2="1329.9297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="224.5" y="1324.8638">OREG - RoundId, Output, PresentedCreds[]</text><path d="M212,1342.9297 L212,1427.9297 L420,1427.9297 L420,1352.9297 L410,1342.9297 L212,1342.9297 " fill="#FBFB77" filter="url(#ftpncyiypvnn3)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M410,1342.9297 L410,1352.9297 L420,1352.9297 L410,1342.9297 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="99" x="218" y="1359.9966">IsRoundFound()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="93" x="218" y="1375.1294">IsORegPhase()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="116" x="218" y="1390.2622">IsStandardScript()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="187" x="218" y="1405.395">EnsureUniqueSerialNumber()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="119" x="218" y="1420.5278">CheckCredProofs()</text><polygon fill="#A80036" points="932,1454.7266,942,1458.7266,932,1462.7266,936,1458.7266" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="202.5" x2="938" y1="1458.7266" y2="1458.7266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="176" x="209.5" y="1453.6606">UnsignedTransactionSecret</text><rect fill="#EEEEEE" filter="url(#ftpncyiypvnn3)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1049" x="3" y="1487.293"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1052" y1="1487.293" y2="1487.293"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1052" y1="1490.293" y2="1490.293"/><rect fill="#EEEEEE" filter="url(#ftpncyiypvnn3)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="164" x="445.5" y="1476.7266"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="145" x="451.5" y="1492.7935">Transaction Signing</text><polygon fill="#A80036" points="218.5,1526.9922,208.5,1530.9922,218.5,1534.9922,214.5,1530.9922" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="212.5" x2="811.5" y1="1530.9922" y2="1530.9922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="202" x="224.5" y="1525.9263">TSIG - RoundId, AliceId, InputSig</text><path d="M212,1543.9922 L212,1613.9922 L334,1613.9922 L334,1553.9922 L324,1543.9922 L212,1543.9922 " fill="#FBFB77" filter="url(#ftpncyiypvnn3)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M324,1543.9922 L324,1553.9922 L334,1553.9922 L324,1543.9922 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="99" x="218" y="1561.0591">IsRoundFound()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="86" x="218" y="1576.1919">IsTSigPhase()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="89" x="218" y="1591.3247">IsAliceFound()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="101" x="218" y="1606.4575">CheckInputSig()</text><polygon fill="#A80036" points="800.5,1640.6563,810.5,1644.6563,800.5,1648.6563,804.5,1644.6563" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="202.5" x2="806.5" y1="1644.6563" y2="1644.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="26" x="209.5" y="1639.5903">ACK</text><polygon fill="#A80036" points="218.5,1669.7891,208.5,1673.7891,218.5,1677.7891,214.5,1673.7891" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="212.5" x2="880.5" y1="1673.7891" y2="1673.7891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="202" x="224.5" y="1668.7231">TSIG - RoundId, AliceId, InputSig</text><path d="M212,1686.7891 L212,1756.7891 L334,1756.7891 L334,1696.7891 L324,1686.7891 L212,1686.7891 " fill="#FBFB77" filter="url(#ftpncyiypvnn3)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M324,1686.7891 L324,1696.7891 L334,1696.7891 L324,1686.7891 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="99" x="218" y="1703.856">IsRoundFound()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="86" x="218" y="1718.9888">IsTSigPhase()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="89" x="218" y="1734.1216">IsAliceFound()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="101" x="218" y="1749.2544">CheckInputSig()</text><polygon fill="#A80036" points="869.5,1783.4531,879.5,1787.4531,869.5,1791.4531,873.5,1787.4531" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="202.5" x2="875.5" y1="1787.4531" y2="1787.4531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="26" x="209.5" y="1782.3872">ACK</text><rect fill="#EEEEEE" filter="url(#ftpncyiypvnn3)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1049" x="3" y="1816.0195"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1052" y1="1816.0195" y2="1816.0195"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1052" y1="1819.0195" y2="1819.0195"/><rect fill="#EEEEEE" filter="url(#ftpncyiypvnn3)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="207" x="424" y="1805.4531"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="188" x="430" y="1821.52">Transaction Broadcasting</text><polygon fill="#A80036" points="965,1855.7188,975,1859.7188,965,1863.7188,969,1859.7188" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="202.5" x2="971" y1="1859.7188" y2="1859.7188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="118" x="209.5" y="1854.6528">SignedTransaction</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="64" x="977" y="1897.5811">Mempool</text><path d="M994,1848.5859 C994,1838.5859 1012,1838.5859 1012,1838.5859 C1012,1838.5859 1030,1838.5859 1030,1848.5859 L1030,1874.5859 C1030,1884.5859 1012,1884.5859 1012,1884.5859 C1012,1884.5859 994,1884.5859 994,1874.5859 L994,1848.5859 " fill="#FEFECE" filter="url(#ftpncyiypvnn3)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M994,1848.5859 C994,1858.5859 1012,1858.5859 1012,1858.5859 C1012,1858.5859 1030,1858.5859 1030,1848.5859 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><polygon fill="#A80036" points="185.5,1928.0156,195.5,1932.0156,185.5,1936.0156,189.5,1932.0156" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="48.5" x2="191.5" y1="1932.0156" y2="1932.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="130" x="55.5" y="1926.9497">GetCoinjoinStatuses</text><polygon fill="#A80036" points="59.5,1957.1484,49.5,1961.1484,59.5,1965.1484,55.5,1961.1484" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="53.5" x2="201.5" y1="1961.1484" y2="1961.1484"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="117" x="65.5" y="1956.0825">CoinjoinStatuses[]</text><!--
@startuml
collections Satoshis
participant Coordinator
participant Alice1
participant Alice2
participant Bob
database Mempool

title Scenario: A Participant Is Consolidating 2 Coins (Alice1, Alice2) Into 1 (Bob)\n

== Input Registration ==

Satoshis -> Coordinator ++ : GetCoinjoinStatuses
return CoinjoinStatuses[]

Alice1 -> Coordinator ++: IREG - RoundId, Input, RoundParamSig, ZeroCredReqs[]
note right of Coordinator
    IsRoundFound()
    IsIRegPhase()
    IsUnspent()
    IsConfirmed()
    IsMature()
    IsStandardScript()
    IsNotMalleable()
    CheckRoundParamSig()
    IsAllowedIfBlameRound()
    IsNotBanned()
    UpdateIfDuplicateInput()
end note
return AliceId, ZeroCreds[]
...

Alice1 -> Coordinator ++: CCONF - RoundId, AliceId, PresentedCreds[], RealCredReqs[], BalanceProof, ZeroCredReqs[]
note right of Coordinator
    IsRoundFound()
    IsIRegOrCConfPhase()
    IsAliceFound()
    EnsureUniqueSerialNumber()
    CheckCredProofs()
end note
return ZeroCreds[]

Alice2 -> Coordinator ++: IREG - RoundId, Input, RoundParamSig, ZeroCredReqs[]
note right of Coordinator
    IsRoundFound()
    IsIRegPhase()
    IsUnspent()
    IsConfirmed()
    IsMature()
    IsStandardScript()
    IsNotMalleable()
    CheckRoundParamSig()
    IsAllowedIfBlameRound()
    IsNotBanned()
    UpdateIfDuplicateInput()
end note
return AliceId, ZeroCreds[]

== Connection Confirmation ==

Alice1 -> Coordinator ++: CCONF - RoundId, AliceId, PresentedCreds[], RealCredReqs[], BalanceProof, ZeroCredReqs[]
note right of Coordinator
    IsRoundFound()
    IsIRegOrCConfPhase()
    IsAliceFound()
    EnsureUniqueSerialNumber()
    CheckCredProofs()
end note
return RealCreds[]

Alice2 -> Coordinator ++: CCONF - RoundId, AliceId, PresentedCreds[], RealCredReqs[], BalanceProof, ZeroCredReqs[]
note right of Coordinator
    IsRoundFound()
    IsIRegOrCConfPhase()
    IsAliceFound()
    EnsureUniqueSerialNumber()
    CheckCredProofs()
end note
return RealCreds[]

== Output Registration ==

Bob -> Coordinator ++: OREG - RoundId, Output, PresentedCreds[]
note right of Coordinator
    IsRoundFound()
    IsORegPhase()
    IsStandardScript()
    EnsureUniqueSerialNumber()
    CheckCredProofs()
end note
return UnsignedTransactionSecret

== Transaction Signing ==

Alice1 -> Coordinator ++: TSIG - RoundId, AliceId, InputSig
note right of Coordinator
    IsRoundFound()
    IsTSigPhase()
    IsAliceFound()
    CheckInputSig()
end note
return ACK

Alice2 -> Coordinator ++: TSIG - RoundId, AliceId, InputSig
note right of Coordinator
    IsRoundFound()
    IsTSigPhase()
    IsAliceFound()
    CheckInputSig()
end note
return ACK

== Transaction Broadcasting ==

Coordinator -> Mempool**  : SignedTransaction

Satoshis -> Coordinator ++ : GetCoinjoinStatuses
return CoinjoinStatuses[]

@enduml

PlantUML version 1.2018.13(Mon Nov 26 17:11:51 UTC 2018)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.7+10-post-Debian-3deb10u1
Operating System: Linux
OS Version: 5.5.7-1.qubes.x86_64
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>